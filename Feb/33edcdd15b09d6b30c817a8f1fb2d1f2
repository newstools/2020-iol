New York — A gunman was arrested after he ambushed police officers in the Bronx twice in 12 hours, authorities said, wounding two in attacks that brought outrage from officials who blamed the violence on an atmosphere of anti-police rhetoric. Robert Williams, 45, of the Bronx, was captured after he walked into a police station in the Bronx and started shooting shortly before 8 am Sunday, police said. His shots struck a lieutenant in the arm and narrowly missed other police personnel before he ran out of bullets, lay down and tossed his pistol, officials said. That attack came just hours after Williams approached a patrol van in the same part of the Bronx and fired at two officers inside, wounding one before escaping on foot, police said. All of those shot are expected to recover, authorities said. "It is only by the grace of God and the heroic actions of those inside the building that took him into custody that we are not talking about police officers murdered inside a New York City police precinct,” Police Commissioner Dermot Shea said at a news conference.  Williams is being charged with attempted murder, criminal weapon possession and resisting arrest, police said in an email late Sunday identifying him as the suspect. He was hospitalised Sunday evening, the Bronx prosecutor's office said. It wasn't clear whether he had an attorney to speak for him. Williams had been upset since his own son died after being shot in the Bronx, the suspect's grandmother “He was depressed at times because his son got shot in the street,” Mary Williams, 80, told the newspaper. “That was his only child.” The officer injured in the first shooting, Paul Stroffolino, was released from the hospital Sunday to applause from colleagues. The officer, a bandage on his neck, gave a thumbs-up.  Shea called Williams a “coward" and said he had a long criminal history, including a 2002 shooting and carjacking in which he fired a gun at police. He was paroled from prison in 2017 after an attempted murder conviction, Shea said. The commissioner also lashed out at criminal justice reform activists who have demonstrated in recent months against excessive force by police, including a large protest in Grand Central Terminal. The protests, he suggested, helped create an anti-police environment. “These things are not unrelated. We had people marching through the streets of New York City recently,” Shea said. “Words matter. And words affect people's behavior.” Shea didn't offer any evidence that Williams knew of those protests or was influenced by them. Mayor Bill de Blasio, who won office partly on a promise to reform overly aggressive policing of minority communities, also suggested that anti-police sentiment had gotten out of hand. “Anyone who spews hatred at our officers is aiding and abetting this kind of atmosphere; it is not acceptable," de Blasio said. “You could protest for whatever you believe in, but you cannot vilely attack those who are here to protect us. It creates this kind of dynamic.” The attacks recalled other unprovoked assaults on police officers sitting in their patrol vehicles. In 2017, a gunman killed Officer Miosotis Familia as she sat in her patrol vehicle in the Bronx. In 2014, two officers, Rafael Ramos and Wenjian Liu, were shot dead in their patrol car in Brooklyn by a man upset about recent police killings of unarmed black men. The killings of Ramos and Liu had also followed large protests. Some officers blamed de Blasio for expressing solidarity with the demonstrations and turned their backs on the Democrat at the funerals. Robert Gangi, executive director of the Police Reform Organizing Project advocacy group, said it was “irresponsible" for Shea and de Blasio to link the weekend's violence to recent demonstrations, which he said involved activists "protesting in a legitimate fashion." There is “no defense for a lunatic who opens fire on police," Gangi said. The first attack happened just before 8:30 p.m. Saturday, when the gunman walked up to the van asking the officers for directions and then fired shots, grazing Stroffolino, who was behind the wheel, in the chin and neck and narrowly missing an artery, authorities said. Stroffolino and his partner for eight years, Brian Hanlon, a friend since middle school, hit the gas to get away. Neither fired a shot. Police released a photo of the suspect and were combing the city for him when he walked into the police station coordinating the manhunt, strolled to the desk and pulled a gun, authorities said. The wounded lieutenant returned fire but missed, and police personnel dashed out of an adjoining room just in time to avoid the pursuing gunman. Two security cameras captured video of the chaotic scene.